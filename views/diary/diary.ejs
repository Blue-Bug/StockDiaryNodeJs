<!doctype html>
<html lang="kr">

<head>
  <%-include ('../header.ejs')%>
    <style>
      body {
        background-color: #495057;
      }
    </style>
    <script>
      function fnExcelDownload(id, title) {
        var tab_text = '<html xmlns:x="urn:schemas-microsoft-com:office:excel">';
        tab_text += '<head><meta http-equiv="content-type" content="application/vnd.ms-excel; charset=UTF-8">';
        tab_text += '<xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet>';
        tab_text += '<x:Name>Sheet</x:Name>';
        tab_text += '<x:WorksheetOptions><x:Panes></x:Panes></x:WorksheetOptions></x:ExcelWorksheet>';
        tab_text += '</x:ExcelWorksheets></x:ExcelWorkbook></xml></head><body>';
        tab_text += "<table border='1px'>";
        var exportTable = $('#' + id).clone();
        exportTable.find('input').each(function (index, elem) { $(elem).remove(); });
        tab_text += exportTable.html();
        tab_text += '</table></body></html>';
        var data_type = 'data:application/vnd.ms-excel';
        var ua = window.navigator.userAgent;
        var msie = ua.indexOf("MSIE ");
        var fileName = title + '.xls'; // IE 환경에서 다운로드 
        if (msie > 0 || !!navigator.userAgent.match(/Trident.*rv\:11\./)) {
          if (window.navigator.msSaveBlob) {
            var blob = new Blob([tab_text], { type: "application/csv;charset=utf-8;" }); navigator.msSaveBlob(blob, fileName);
          }
        }
        else {
          var blob2 = new Blob([tab_text], { type: "application/csv;charset=utf-8;" });
          var filename = fileName; var elem = window.document.createElement('a');
          elem.href = window.URL.createObjectURL(blob2);
          elem.download = filename;
          document.body.appendChild(elem); elem.click();
          document.body.removeChild(elem);
        }
      };
    </script>
</head>

<body>
  <%-include ('../sidebar.ejs')%>
    <div class="container">
      <div class="overflow-auto">
        <div class="table-responsive-sm">
          <table id = "DiaryTable" class="table table-bordered">
            <thead class="table-light align-middle">
              <th scope="col">#</th>
              <th scope="col">종목명</th>
              <th scope="col">증권사</th>
              <th scope="col">매매 구분</th>
              <th scope="col">매수 일자</th>
              <th scope="col">매도 일자</th>
              <th scope="col">보유 기간</th>
              <th scope="col">손익</th>
              <th scope="col">수익률</th>
              <th scope="col">체결 단가</th>
              <th scope="col">체결 수량</th>
              <th scope="col">매매 비용</th>
              <th scope="col">총 체결 금액</th>
              <th scope="col">매매 이유</th>
            </thead>
            <tbody class="text-white">
              <% let index=1%>
                <!--여기부터 하나씩 for문으로 출력-->
                <% diary.forEach((it)=> {%>
                  <tr>
                    <td>
                      <%= index++%>
                    </td>
                    <td>
                      <%= it.item %>
                    </td>
                    <td>
                      <%= it.bank %>
                    </td>
                    <td>
                      <%= it.trade_category %>
                    </td>
                    <td>
                      <%= it.buy_date %>
                    </td>
                    <td>
                      <%= it.sell_date %>
                    </td>
                    <td>
                      <%= it.holding_period %>
                    </td>
                    <td>
                      <%= it.profit_loss %>
                    </td>
                    <td>
                      <%= it.profit_rate %>
                    </td>
                    <td>
                      <%= it.transaction_price %>
                    </td>
                    <td>
                      <%= it.transaction_volume %>
                    </td>
                    <td>
                      <%= it.trading_cost %>
                    </td>
                    <td>
                      <%= it.total_price %>
                    </td>
                    <td>
                      <%= it.trading_reason %>
                    </td>
                  </tr>
                  <%}); //end for%>
            </tbody>
          </table>
        </div>
      </div>
    </div>




</body>

</html>